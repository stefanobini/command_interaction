Loaded </home/sbini_loc/command_interaction/training/settings/FELICE_conf.py> as configuration file.
CUDA acceleration available on <5> devices: <[0, 1, 2, 3, 4]>
The current device is <0>, you select device <2>
Global seed set to 2
The TensorBoard logggers will be saved in <lightning_logs/FELICE/demo7/ita/conformer/UniCL_PEM_v2_conv_first>.
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
The following callbacks returned in `LightningModule.configure_callbacks` will override existing callbacks passed to Trainer: ModelCheckpoint
/home/sbini_loc/anaconda3/envs/dgx2/lib/python3.9/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory lightning_logs/FELICE/demo7/ita/conformer/UniCL_PEM_v2_conv_first/checkpoints exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0,1,2,3,4]

  | Name    | Type             | Params
---------------------------------------------
0 | model   | Conformer        | 136 K 
1 | output  | Linear           | 287   
2 | softmax | Softmax          | 0     
3 | loss_fn | CrossEntropyLoss | 0     
---------------------------------------------
136 K     Trainable params
0         Non-trainable params
136 K     Total params
0.546     Total estimated model params size (MB)
Training: 0it [00:00, ?it/s]Training:   0%|          | 0/2297 [00:00<?, ?it/s]Epoch 0:   0%|          | 0/2297 [00:00<?, ?it/s] Epoch 0:   0%|          | 1/2297 [00:03<2:31:44,  3.97s/it]Epoch 0:   0%|          | 1/2297 [00:03<2:31:46,  3.97s/it, v_num=irst]Epoch 0:   0%|          | 2/2297 [00:04<1:25:13,  2.23s/it, v_num=irst]Epoch 0:   0%|          | 2/2297 [00:04<1:25:13,  2.23s/it, v_num=irst]Epoch 0:   0%|          | 3/2297 [00:04<57:13,  1.50s/it, v_num=irst]  Epoch 0:   0%|          | 3/2297 [00:04<57:13,  1.50s/it, v_num=irst]Epoch 0:   0%|          | 4/2297 [00:04<43:09,  1.13s/it, v_num=irst]Epoch 0:   0%|          | 4/2297 [00:04<43:09,  1.13s/it, v_num=irst]Epoch 0:   0%|          | 5/2297 [00:04<34:43,  1.10it/s, v_num=irst]Epoch 0:   0%|          | 5/2297 [00:04<34:43,  1.10it/s, v_num=irst]Epoch 0:   0%|          | 6/2297 [00:04<29:05,  1.31it/s, v_num=irst]Epoch 0:   0%|          | 6/2297 [00:04<29:06,  1.31it/s, v_num=irst]Epoch 0:   0%|          | 7/2297 [00:04<25:04,  1.52it/s, v_num=irst]Epoch 0:   0%|          | 7/2297 [00:04<25:04,  1.52it/s, v_num=irst]Epoch 0:   0%|          | 8/2297 [00:04<22:03,  1.73it/s, v_num=irst]Epoch 0:   0%|          | 8/2297 [00:04<22:03,  1.73it/s, v_num=irst]Epoch 0:   0%|          | 9/2297 [00:04<19:43,  1.93it/s, v_num=irst]Epoch 0:   0%|          | 9/2297 [00:04<19:43,  1.93it/s, v_num=irst]Epoch 0:   0%|          | 10/2297 [00:04<17:53,  2.13it/s, v_num=irst]Epoch 0:   0%|          | 10/2297 [00:04<17:53,  2.13it/s, v_num=irst]Epoch 0:   0%|          | 11/2297 [00:04<16:25,  2.32it/s, v_num=irst]Epoch 0:   0%|          | 11/2297 [00:04<16:25,  2.32it/s, v_num=irst]Epoch 0:   1%|          | 12/2297 [00:04<15:11,  2.51it/s, v_num=irst]Epoch 0:   1%|          | 12/2297 [00:04<15:11,  2.51it/s, v_num=irst]Epoch 0:   1%|          | 13/2297 [00:04<14:07,  2.69it/s, v_num=irst]Epoch 0:   1%|          | 13/2297 [00:04<14:07,  2.69it/s, v_num=irst]Epoch 0:   1%|          | 14/2297 [00:04<13:13,  2.88it/s, v_num=irst]Epoch 0:   1%|          | 14/2297 [00:04<13:13,  2.88it/s, v_num=irst]Epoch 0:   1%|          | 15/2297 [00:04<12:28,  3.05it/s, v_num=irst]Epoch 0:   1%|          | 15/2297 [00:04<12:28,  3.05it/s, v_num=irst]Epoch 0:   1%|          | 16/2297 [00:04<11:46,  3.23it/s, v_num=irst]Epoch 0:   1%|          | 16/2297 [00:04<11:46,  3.23it/s, v_num=irst]Epoch 0:   1%|          | 17/2297 [00:04<11:10,  3.40it/s, v_num=irst]Epoch 0:   1%|          | 17/2297 [00:04<11:10,  3.40it/s, v_num=irst]Epoch 0:   1%|          | 18/2297 [00:05<10:38,  3.57it/s, v_num=irst]Epoch 0:   1%|          | 18/2297 [00:05<10:38,  3.57it/s, v_num=irst]Epoch 0:   1%|          | 19/2297 [00:05<10:09,  3.74it/s, v_num=irst]Epoch 0:   1%|          | 19/2297 [00:05<10:09,  3.74it/s, v_num=irst]Epoch 0:   1%|          | 20/2297 [00:05<09:43,  3.90it/s, v_num=irst]Epoch 0:   1%|          | 20/2297 [00:05<09:43,  3.90it/s, v_num=irst]Epoch 0:   1%|          | 21/2297 [00:05<09:20,  4.06it/s, v_num=irst]Epoch 0:   1%|          | 21/2297 [00:05<09:20,  4.06it/s, v_num=irst]Epoch 0:   1%|          | 22/2297 [00:05<08:59,  4.22it/s, v_num=irst]Epoch 0:   1%|          | 22/2297 [00:05<08:59,  4.22it/s, v_num=irst]Epoch 0:   1%|          | 23/2297 [00:05<08:40,  4.37it/s, v_num=irst]Epoch 0:   1%|          | 23/2297 [00:05<08:40,  4.37it/s, v_num=irst]Epoch 0:   1%|          | 24/2297 [00:05<08:21,  4.53it/s, v_num=irst]Epoch 0:   1%|          | 24/2297 [00:05<08:21,  4.53it/s, v_num=irst]Epoch 0:   1%|          | 25/2297 [00:05<08:04,  4.69it/s, v_num=irst]Epoch 0:   1%|          | 25/2297 [00:05<08:04,  4.69it/s, v_num=irst]Epoch 0:   1%|          | 26/2297 [00:05<07:49,  4.84it/s, v_num=irst]Epoch 0:   1%|          | 26/2297 [00:05<07:49,  4.84it/s, v_num=irst]Epoch 0:   1%|          | 27/2297 [00:05<07:35,  4.99it/s, v_num=irst]Epoch 0:   1%|          | 27/2297 [00:05<07:35,  4.99it/s, v_num=irst]Epoch 0:   1%|          | 28/2297 [00:05<07:23,  5.12it/s, v_num=irst]Epoch 0:   1%|          | 28/2297 [00:05<07:23,  5.12it/s, v_num=irst]Epoch 0:   1%|▏         | 29/2297 [00:05<07:11,  5.25it/s, v_num=irst]Epoch 0:   1%|▏         | 29/2297 [00:05<07:11,  5.25it/s, v_num=irst]Epoch 0:   1%|▏         | 30/2297 [00:05<07:22,  5.12it/s, v_num=irst]Epoch 0:   1%|▏         | 30/2297 [00:05<07:22,  5.12it/s, v_num=irst]Epoch 0:   1%|▏         | 31/2297 [00:06<07:33,  4.99it/s, v_num=irst]Epoch 0:   1%|▏         | 31/2297 [00:06<07:33,  4.99it/s, v_num=irst]Epoch 0:   1%|▏         | 32/2297 [00:06<07:22,  5.12it/s, v_num=irst]Epoch 0:   1%|▏         | 32/2297 [00:06<07:22,  5.12it/s, v_num=irst]Epoch 0:   1%|▏         | 33/2297 [00:06<07:12,  5.24it/s, v_num=irst]Epoch 0:   1%|▏         | 33/2297 [00:06<07:12,  5.24it/s, v_num=irst]Epoch 0:   1%|▏         | 34/2297 [00:06<07:01,  5.37it/s, v_num=irst]Epoch 0:   1%|▏         | 34/2297 [00:06<07:01,  5.37it/s, v_num=irst]Epoch 0:   2%|▏         | 35/2297 [00:06<06:52,  5.49it/s, v_num=irst]Epoch 0:   2%|▏         | 35/2297 [00:06<06:52,  5.49it/s, v_num=irst]Epoch 0:   2%|▏         | 36/2297 [00:06<06:43,  5.60it/s, v_num=irst]Epoch 0:   2%|▏         | 36/2297 [00:06<06:43,  5.60it/s, v_num=irst]Epoch 0:   2%|▏         | 37/2297 [00:06<06:35,  5.72it/s, v_num=irst]Epoch 0:   2%|▏         | 37/2297 [00:06<06:35,  5.72it/s, v_num=irst]Epoch 0:   2%|▏         | 38/2297 [00:06<06:27,  5.83it/s, v_num=irst]Epoch 0:   2%|▏         | 38/2297 [00:06<06:27,  5.83it/s, v_num=irst]Epoch 0:   2%|▏         | 39/2297 [00:06<06:20,  5.94it/s, v_num=irst]Epoch 0:   2%|▏         | 39/2297 [00:06<06:20,  5.94it/s, v_num=irst]Epoch 0:   2%|▏         | 40/2297 [00:06<06:13,  6.05it/s, v_num=irst]Epoch 0:   2%|▏         | 40/2297 [00:06<06:13,  6.05it/s, v_num=irst]Epoch 0:   2%|▏         | 41/2297 [00:06<06:05,  6.17it/s, v_num=irst]Epoch 0:   2%|▏         | 41/2297 [00:06<06:05,  6.17it/s, v_num=irst]Epoch 0:   2%|▏         | 42/2297 [00:06<05:59,  6.27it/s, v_num=irst]Epoch 0:   2%|▏         | 42/2297 [00:06<05:59,  6.27it/s, v_num=irst]Epoch 0:   2%|▏         | 43/2297 [00:06<05:53,  6.38it/s, v_num=irst]Epoch 0:   2%|▏         | 43/2297 [00:06<05:53,  6.38it/s, v_num=irst]Epoch 0:   2%|▏         | 44/2297 [00:06<05:47,  6.48it/s, v_num=irst]Epoch 0:   2%|▏         | 44/2297 [00:06<05:47,  6.48it/s, v_num=irst]Epoch 0:   2%|▏         | 45/2297 [00:06<05:41,  6.60it/s, v_num=irst]Epoch 0:   2%|▏         | 45/2297 [00:06<05:41,  6.60it/s, v_num=irst]Epoch 0:   2%|▏         | 46/2297 [00:06<05:36,  6.70it/s, v_num=irst]Epoch 0:   2%|▏         | 46/2297 [00:06<05:36,  6.70it/s, v_num=irst]Epoch 0:   2%|▏         | 47/2297 [00:06<05:31,  6.79it/s, v_num=irst]Epoch 0:   2%|▏         | 47/2297 [00:06<05:31,  6.79it/s, v_num=irst]Epoch 0:   2%|▏         | 48/2297 [00:06<05:25,  6.90it/s, v_num=irst]Epoch 0:   2%|▏         | 48/2297 [00:06<05:25,  6.90it/s, v_num=irst]Epoch 0:   2%|▏         | 49/2297 [00:07<05:22,  6.97it/s, v_num=irst]Epoch 0:   2%|▏         | 49/2297 [00:07<05:22,  6.97it/s, v_num=irst]Epoch 0:   2%|▏         | 50/2297 [00:07<05:18,  7.06it/s, v_num=irst]Epoch 0:   2%|▏         | 50/2297 [00:07<05:18,  7.06it/s, v_num=irst]Epoch 0:   2%|▏         | 51/2297 [00:07<05:14,  7.15it/s, v_num=irst]Epoch 0:   2%|▏         | 51/2297 [00:07<05:14,  7.15it/s, v_num=irst]Epoch 0:   2%|▏         | 52/2297 [00:07<05:09,  7.24it/s, v_num=irst]Epoch 0:   2%|▏         | 52/2297 [00:07<05:09,  7.24it/s, v_num=irst]Epoch 0:   2%|▏         | 53/2297 [00:07<05:05,  7.34it/s, v_num=irst]Epoch 0:   2%|▏         | 53/2297 [00:07<05:05,  7.34it/s, v_num=irst]Epoch 0:   2%|▏         | 54/2297 [00:07<05:02,  7.43it/s, v_num=irst]Epoch 0:   2%|▏         | 54/2297 [00:07<05:02,  7.43it/s, v_num=irst]Epoch 0:   2%|▏         | 55/2297 [00:07<05:02,  7.41it/s, v_num=irst]Epoch 0:   2%|▏         | 55/2297 [00:07<05:02,  7.41it/s, v_num=irst]Epoch 0:   2%|▏         | 56/2297 [00:07<04:58,  7.51it/s, v_num=irst]Epoch 0:   2%|▏         | 56/2297 [00:07<04:58,  7.51it/s, v_num=irst]Epoch 0:   2%|▏         | 57/2297 [00:07<04:54,  7.59it/s, v_num=irst]Epoch 0:   2%|▏         | 57/2297 [00:07<04:54,  7.59it/s, v_num=irst]Epoch 0:   3%|▎         | 58/2297 [00:07<04:51,  7.68it/s, v_num=irst]Epoch 0:   3%|▎         | 58/2297 [00:07<04:51,  7.68it/s, v_num=irst]Epoch 0:   3%|▎         | 59/2297 [00:07<04:48,  7.77it/s, v_num=irst]Epoch 0:   3%|▎         | 59/2297 [00:07<04:48,  7.77it/s, v_num=irst]Epoch 0:   3%|▎         | 60/2297 [00:07<04:44,  7.85it/s, v_num=irst]Epoch 0:   3%|▎         | 60/2297 [00:07<04:44,  7.85it/s, v_num=irst]Epoch 0:   3%|▎         | 61/2297 [00:07<04:41,  7.93it/s, v_num=irst]Epoch 0:   3%|▎         | 61/2297 [00:07<04:41,  7.93it/s, v_num=irst]Epoch 0:   3%|▎         | 62/2297 [00:07<04:38,  8.02it/s, v_num=irst]Epoch 0:   3%|▎         | 62/2297 [00:07<04:38,  8.02it/s, v_num=irst]Epoch 0:   3%|▎         | 63/2297 [00:07<04:36,  8.09it/s, v_num=irst]Epoch 0:   3%|▎         | 63/2297 [00:07<04:36,  8.09it/s, v_num=irst]Epoch 0:   3%|▎         | 64/2297 [00:07<04:33,  8.17it/s, v_num=irst]Epoch 0:   3%|▎         | 64/2297 [00:07<04:33,  8.17it/s, v_num=irst]Epoch 0:   3%|▎         | 65/2297 [00:07<04:30,  8.25it/s, v_num=irst]Epoch 0:   3%|▎         | 65/2297 [00:07<04:30,  8.25it/s, v_num=irst]Epoch 0:   3%|▎         | 66/2297 [00:07<04:27,  8.33it/s, v_num=irst]Epoch 0:   3%|▎         | 66/2297 [00:07<04:27,  8.33it/s, v_num=irst]Epoch 0:   3%|▎         | 67/2297 [00:07<04:24,  8.42it/s, v_num=irst]Epoch 0:   3%|▎         | 67/2297 [00:07<04:24,  8.42it/s, v_num=irst]Epoch 0:   3%|▎         | 68/2297 [00:07<04:22,  8.51it/s, v_num=irst]Epoch 0:   3%|▎         | 68/2297 [00:07<04:22,  8.51it/s, v_num=irst]Epoch 0:   3%|▎         | 69/2297 [00:08<04:19,  8.60it/s, v_num=irst]Epoch 0:   3%|▎         | 69/2297 [00:08<04:19,  8.60it/s, v_num=irst]Epoch 0:   3%|▎         | 70/2297 [00:08<04:16,  8.68it/s, v_num=irst]Epoch 0:   3%|▎         | 70/2297 [00:08<04:16,  8.68it/s, v_num=irst]Epoch 0:   3%|▎         | 71/2297 [00:08<04:13,  8.77it/s, v_num=irst]Epoch 0:   3%|▎         | 71/2297 [00:08<04:13,  8.77it/s, v_num=irst]Epoch 0:   3%|▎         | 72/2297 [00:08<04:11,  8.85it/s, v_num=irst]Epoch 0:   3%|▎         | 72/2297 [00:08<04:11,  8.85it/s, v_num=irst]Epoch 0:   3%|▎         | 73/2297 [00:08<04:08,  8.94it/s, v_num=irst]Epoch 0:   3%|▎         | 73/2297 [00:08<04:08,  8.94it/s, v_num=irst]Epoch 0:   3%|▎         | 74/2297 [00:08<04:06,  9.01it/s, v_num=irst]Epoch 0:   3%|▎         | 74/2297 [00:08<04:06,  9.01it/s, v_num=irst]Epoch 0:   3%|▎         | 75/2297 [00:08<04:04,  9.10it/s, v_num=irst]Epoch 0:   3%|▎         | 75/2297 [00:08<04:04,  9.10it/s, v_num=irst]Epoch 0:   3%|▎         | 76/2297 [00:08<04:02,  9.17it/s, v_num=irst]Epoch 0:   3%|▎         | 76/2297 [00:08<04:02,  9.17it/s, v_num=irst]Epoch 0:   3%|▎         | 77/2297 [00:08<04:00,  9.25it/s, v_num=irst]Epoch 0:   3%|▎         | 77/2297 [00:08<04:00,  9.25it/s, v_num=irst]Epoch 0:   3%|▎         | 78/2297 [00:08<03:58,  9.32it/s, v_num=irst]Epoch 0:   3%|▎         | 78/2297 [00:08<03:58,  9.32it/s, v_num=irst]Epoch 0:   3%|▎         | 79/2297 [00:08<03:56,  9.38it/s, v_num=irst]Epoch 0:   3%|▎         | 79/2297 [00:08<03:56,  9.38it/s, v_num=irst]Epoch 0:   3%|▎         | 80/2297 [00:08<03:54,  9.47it/s, v_num=irst]Epoch 0:   3%|▎         | 80/2297 [00:08<03:54,  9.47it/s, v_num=irst]Epoch 0:   4%|▎         | 81/2297 [00:08<03:52,  9.54it/s, v_num=irst]Epoch 0:   4%|▎         | 81/2297 [00:08<03:52,  9.54it/s, v_num=irst]Epoch 0:   4%|▎         | 82/2297 [00:08<03:50,  9.62it/s, v_num=irst]Epoch 0:   4%|▎         | 82/2297 [00:08<03:50,  9.62it/s, v_num=irst]Epoch 0:   4%|▎         | 83/2297 [00:08<03:48,  9.70it/s, v_num=irst]Epoch 0:   4%|▎         | 83/2297 [00:08<03:48,  9.70it/s, v_num=irst]Epoch 0:   4%|▎         | 84/2297 [00:08<03:46,  9.79it/s, v_num=irst]Epoch 0:   4%|▎         | 84/2297 [00:08<03:46,  9.79it/s, v_num=irst]Epoch 0:   4%|▎         | 85/2297 [00:08<03:44,  9.85it/s, v_num=irst]Epoch 0:   4%|▎         | 85/2297 [00:08<03:44,  9.85it/s, v_num=irst]Epoch 0:   4%|▎         | 86/2297 [00:08<03:43,  9.90it/s, v_num=irst]Epoch 0:   4%|▎         | 86/2297 [00:08<03:43,  9.90it/s, v_num=irst]Epoch 0:   4%|▍         | 87/2297 [00:08<03:42,  9.95it/s, v_num=irst]Epoch 0:   4%|▍         | 87/2297 [00:08<03:42,  9.95it/s, v_num=irst]Epoch 0:   4%|▍         | 88/2297 [00:08<03:40, 10.01it/s, v_num=irst]Epoch 0:   4%|▍         | 88/2297 [00:08<03:40, 10.01it/s, v_num=irst]Epoch 0:   4%|▍         | 89/2297 [00:08<03:39, 10.08it/s, v_num=irst]Epoch 0:   4%|▍         | 89/2297 [00:08<03:39, 10.08it/s, v_num=irst]Epoch 0:   4%|▍         | 90/2297 [00:08<03:37, 10.15it/s, v_num=irst]Epoch 0:   4%|▍         | 90/2297 [00:08<03:37, 10.15it/s, v_num=irst]Epoch 0:   4%|▍         | 91/2297 [00:08<03:36, 10.21it/s, v_num=irst]Epoch 0:   4%|▍         | 91/2297 [00:08<03:36, 10.21it/s, v_num=irst]Epoch 0:   4%|▍         | 92/2297 [00:08<03:34, 10.28it/s, v_num=irst]Epoch 0:   4%|▍         | 92/2297 [00:08<03:34, 10.28it/s, v_num=irst]Epoch 0:   4%|▍         | 93/2297 [00:08<03:32, 10.35it/s, v_num=irst]Epoch 0:   4%|▍         | 93/2297 [00:08<03:32, 10.35it/s, v_num=irst]Epoch 0:   4%|▍         | 94/2297 [00:09<03:31, 10.40it/s, v_num=irst]Epoch 0:   4%|▍         | 94/2297 [00:09<03:31, 10.40it/s, v_num=irst]Epoch 0:   4%|▍         | 95/2297 [00:09<03:30, 10.44it/s, v_num=irst]Epoch 0:   4%|▍         | 95/2297 [00:09<03:30, 10.44it/s, v_num=irst]Epoch 0:   4%|▍         | 96/2297 [00:09<03:29, 10.49it/s, v_num=irst]Epoch 0:   4%|▍         | 96/2297 [00:09<03:29, 10.49it/s, v_num=irst]Epoch 0:   4%|▍         | 97/2297 [00:09<03:28, 10.55it/s, v_num=irst]Epoch 0:   4%|▍         | 97/2297 [00:09<03:28, 10.55it/s, v_num=irst]Epoch 0:   4%|▍         | 98/2297 [00:09<03:26, 10.63it/s, v_num=irst]Epoch 0:   4%|▍         | 98/2297 [00:09<03:26, 10.63it/s, v_num=irst]Epoch 0:   4%|▍         | 99/2297 [00:09<03:25, 10.67it/s, v_num=irst]Epoch 0:   4%|▍         | 99/2297 [00:09<03:25, 10.67it/s, v_num=irst]Epoch 0:   4%|▍         | 100/2297 [00:09<03:29, 10.50it/s, v_num=irst]Epoch 0:   4%|▍         | 100/2297 [00:09<03:29, 10.50it/s, v_num=irst]Epoch 0:   4%|▍         | 101/2297 [00:09<03:27, 10.58it/s, v_num=irst]Epoch 0:   4%|▍         | 101/2297 [00:09<03:27, 10.58it/s, v_num=irst]Epoch 0:   4%|▍         | 102/2297 [00:09<03:26, 10.64it/s, v_num=irst]Epoch 0:   4%|▍         | 102/2297 [00:09<03:26, 10.64it/s, v_num=irst]Epoch 0:   4%|▍         | 103/2297 [00:09<03:27, 10.59it/s, v_num=irst]Epoch 0:   4%|▍         | 103/2297 [00:09<03:27, 10.59it/s, v_num=irst]Epoch 0:   5%|▍         | 104/2297 [00:09<03:25, 10.65it/s, v_num=irst]Epoch 0:   5%|▍         | 104/2297 [00:09<03:26, 10.65it/s, v_num=irst]Epoch 0:   5%|▍         | 105/2297 [00:09<03:24, 10.71it/s, v_num=irst]Epoch 0:   5%|▍         | 105/2297 [00:09<03:24, 10.71it/s, v_num=irst]Traceback (most recent call last):
  File "/home/sbini_loc/command_interaction/training/train.py", line 182, in <module>
    trainer.fit(model=model, train_dataloaders=model.train_loader, val_dataloaders=model.val_loader)
  File "/home/sbini_loc/anaconda3/envs/dgx2/lib/python3.9/site-packages/pytorch_lightning/trainer/trainer.py", line 520, in fit
    call._call_and_handle_interrupt(
  File "/home/sbini_loc/anaconda3/envs/dgx2/lib/python3.9/site-packages/pytorch_lightning/trainer/call.py", line 44, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
  File "/home/sbini_loc/anaconda3/envs/dgx2/lib/python3.9/site-packages/pytorch_lightning/trainer/trainer.py", line 559, in _fit_impl
    self._run(model, ckpt_path=ckpt_path)
  File "/home/sbini_loc/anaconda3/envs/dgx2/lib/python3.9/site-packages/pytorch_lightning/trainer/trainer.py", line 935, in _run
    results = self._run_stage()
  File "/home/sbini_loc/anaconda3/envs/dgx2/lib/python3.9/site-packages/pytorch_lightning/trainer/trainer.py", line 978, in _run_stage
    self.fit_loop.run()
  File "/home/sbini_loc/anaconda3/envs/dgx2/lib/python3.9/site-packages/pytorch_lightning/loops/fit_loop.py", line 201, in run
    self.advance()
  File "/home/sbini_loc/anaconda3/envs/dgx2/lib/python3.9/site-packages/pytorch_lightning/loops/fit_loop.py", line 354, in advance
    self.epoch_loop.run(self._data_fetcher)
  File "/home/sbini_loc/anaconda3/envs/dgx2/lib/python3.9/site-packages/pytorch_lightning/loops/training_epoch_loop.py", line 133, in run
    self.advance(data_fetcher)
  File "/home/sbini_loc/anaconda3/envs/dgx2/lib/python3.9/site-packages/pytorch_lightning/loops/training_epoch_loop.py", line 218, in advance
    batch_output = self.automatic_optimization.run(trainer.optimizers[0], kwargs)
  File "/home/sbini_loc/anaconda3/envs/dgx2/lib/python3.9/site-packages/pytorch_lightning/loops/optimization/automatic.py", line 185, in run
    self._optimizer_step(kwargs.get("batch_idx", 0), closure)
  File "/home/sbini_loc/anaconda3/envs/dgx2/lib/python3.9/site-packages/pytorch_lightning/loops/optimization/automatic.py", line 261, in _optimizer_step
    call._call_lightning_module_hook(
  File "/home/sbini_loc/anaconda3/envs/dgx2/lib/python3.9/site-packages/pytorch_lightning/trainer/call.py", line 142, in _call_lightning_module_hook
    output = fn(*args, **kwargs)
  File "/home/sbini_loc/anaconda3/envs/dgx2/lib/python3.9/site-packages/pytorch_lightning/core/module.py", line 1266, in optimizer_step
    optimizer.step(closure=optimizer_closure)
  File "/home/sbini_loc/anaconda3/envs/dgx2/lib/python3.9/site-packages/pytorch_lightning/core/optimizer.py", line 158, in step
    step_output = self._strategy.optimizer_step(self._optimizer, closure, **kwargs)
  File "/home/sbini_loc/anaconda3/envs/dgx2/lib/python3.9/site-packages/pytorch_lightning/strategies/strategy.py", line 224, in optimizer_step
    return self.precision_plugin.optimizer_step(optimizer, model=model, closure=closure, **kwargs)
  File "/home/sbini_loc/anaconda3/envs/dgx2/lib/python3.9/site-packages/pytorch_lightning/plugins/precision/precision_plugin.py", line 114, in optimizer_step
    return optimizer.step(closure=closure, **kwargs)
  File "/home/sbini_loc/anaconda3/envs/dgx2/lib/python3.9/site-packages/torch/optim/optimizer.py", line 280, in wrapper
    out = func(*args, **kwargs)
  File "/home/sbini_loc/anaconda3/envs/dgx2/lib/python3.9/site-packages/torch/optim/optimizer.py", line 33, in _use_grad
    ret = func(self, *args, **kwargs)
  File "/home/sbini_loc/anaconda3/envs/dgx2/lib/python3.9/site-packages/torch/optim/adam.py", line 121, in step
    loss = closure()
  File "/home/sbini_loc/anaconda3/envs/dgx2/lib/python3.9/site-packages/pytorch_lightning/plugins/precision/precision_plugin.py", line 101, in _wrap_closure
    closure_result = closure()
  File "/home/sbini_loc/anaconda3/envs/dgx2/lib/python3.9/site-packages/pytorch_lightning/loops/optimization/automatic.py", line 140, in __call__
    self._result = self.closure(*args, **kwargs)
  File "/home/sbini_loc/anaconda3/envs/dgx2/lib/python3.9/site-packages/pytorch_lightning/loops/optimization/automatic.py", line 126, in closure
    step_output = self._step_fn()
  File "/home/sbini_loc/anaconda3/envs/dgx2/lib/python3.9/site-packages/pytorch_lightning/loops/optimization/automatic.py", line 308, in _training_step
    training_step_output = call._call_strategy_hook(trainer, "training_step", *kwargs.values())
  File "/home/sbini_loc/anaconda3/envs/dgx2/lib/python3.9/site-packages/pytorch_lightning/trainer/call.py", line 288, in _call_strategy_hook
    output = fn(*args, **kwargs)
  File "/home/sbini_loc/anaconda3/envs/dgx2/lib/python3.9/site-packages/pytorch_lightning/strategies/strategy.py", line 366, in training_step
    return self.model.training_step(*args, **kwargs)
  File "/home/sbini_loc/command_interaction/training/models/pl_backbone.py", line 241, in training_step
    logits = self.forward(x=x)
  File "/home/sbini_loc/command_interaction/training/models/pl_backbone.py", line 113, in forward
    x = self.get_embeddings(x=x)
  File "/home/sbini_loc/command_interaction/training/models/conformer.py", line 39, in get_embeddings
    y, lenghts = self.model.forward(input=x, lengths=lengths)
  File "/home/sbini_loc/anaconda3/envs/dgx2/lib/python3.9/site-packages/torchaudio/models/conformer.py", line 292, in forward
    x = layer(x, encoder_padding_mask)
  File "/home/sbini_loc/anaconda3/envs/dgx2/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/sbini_loc/anaconda3/envs/dgx2/lib/python3.9/site-packages/torchaudio/models/conformer.py", line 194, in forward
    x, _ = self.self_attn(
  File "/home/sbini_loc/anaconda3/envs/dgx2/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/sbini_loc/anaconda3/envs/dgx2/lib/python3.9/site-packages/torch/nn/modules/activation.py", line 1189, in forward
    attn_output, attn_output_weights = F.multi_head_attention_forward(
  File "/home/sbini_loc/anaconda3/envs/dgx2/lib/python3.9/site-packages/torch/nn/functional.py", line 5334, in multi_head_attention_forward
    attn_output = scaled_dot_product_attention(q, k, v, attn_mask, dropout_p, is_causal)
torch.cuda.OutOfMemoryError: CUDA out of memory. Tried to allocate 4.22 GiB (GPU 2; 39.45 GiB total capacity; 33.68 GiB already allocated; 4.01 GiB free; 34.91 GiB reserved in total by PyTorch) If reserved memory is >> allocated memory try setting max_split_size_mb to avoid fragmentation.  See documentation for Memory Management and PYTORCH_CUDA_ALLOC_CONF
Epoch 0:   5%|▍         | 105/2297 [00:28<09:44,  3.75it/s, v_num=irst]
