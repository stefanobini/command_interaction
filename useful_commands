# Docker for WHOLE DEMO
sudo docker build -t unisa_docker . --network=host 2>&1 | tee docker_log.txt #--no-cache
# AWS (Aaeon)
sudo docker run --rm --privileged --device /dev/snd --volume=/dev:/dev --volume=/media/aaeon/ext_dev/command_interaction/ROS:/home/felice/command_interaction/ROS --network="host" --runtime nvidia -dit --name unisa_container unisa_image
# Robot
sudo docker run --rm --privileged --device /dev/snd --volume=/dev:/dev --volume=/home/felice/command_interaction/ROS:/home/felice/command_interaction/ROS --network="host" --runtime nvidia -dit --name unisa_container unisa_docker
# Avvio docker
sudo docker exec -it unisa_container /bin/bash

# to load pretrained model (it needs for compatibility reasons)
mkdir -p /root/.cache/torch/hub/checkpoints/
cp /home/felice/command_interaction/ROS/hri_ws/src/gesture_pkg/models/mobilenet_v3_large-8738ca79.pth /root/.cache/torch/hub/checkpoints/

# In the docker - Avvio demo
cd home/felice/command_interaction/ROS/hri_ws/
source devel/setup.bash

'''For FELICE'''
# Demo Speech
roslaunch speech_pkg felice_speech_demo.launch
# Demo Gesture
roslaunch gesture_pkg felice_gesture_demo.launch
# Demo all
roslaunch src/launch/felice_demo.launch

# roslaunch gesture_pkg gesture_demo_felice.launch
# roslaunch gesture_pkg gesture_demo_pepper.launch
# roslaunch gesture_pkg gesture_demo_webview.launch

# roslaunch webserver_pkg gesture_demo.launch

# ROS framework
source /opt/ros/melodic/setup.bash  # create workspace
catkin_make                         # configure workspace

# Automatically update date
sudo date -s "$(wget -qSO- --max-redirect=0 google.com 2>&1 | grep Date: | cut -d' ' -f5-8)Z"

# Change Jetson power mode
cat /etc/nvpmodel.conf          # To See all available modes.
sudo /usr/sbin/nvpmodel -q      # To see current mode.
sudo /usr/sbin/nvpmodel -m 2    # To change power mode. The last number is the selected mode.

# Network
watch -n1 iwconfig  # Signal power
nmcli dev wifi  # List of network

# Visual Studio Code
https://code.visualstudio.com/download	# download .deb version
sudo dpkg -i code_1.68.1-1655262036_arm64.deb
sudo apt install apt-transport-https
sudo apt update
sudo apt install code

# JTop
sudo apt-get install python3-pip
sudo -H pip3 install -U jetson-stats

# GitHub
git config --global user.email "sbini@unisa.it"
git config --global user.name "stefanobini"
git config --global credential.helper store
git pull --no-edit

# To detect audio device
python3 -m pip install sounddevice
python3 -m sounddevice

# For camera info
v4l2-ctl --list-devices  # list device
v4l2-ctl --list-formats-ext # frame size, frame rate

# FIWARE
CONTEXT_BROAKER = "192.168.2.106"
curl http://192.168.1.106:1026/v2/entities/UNISA.SpeechGestureAnalysis.SystemHealth:ac55f166-037c-11ed-a48a-d8c0a69b3641 -s -S -X DELETE
curl http://25.45.111.204:1026/v2/entities/UNISA.SpeechGestureAnalysis.Speech?type={UserInput} -s -S -X DELETE